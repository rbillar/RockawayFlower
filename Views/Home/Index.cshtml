@{
    ViewData["Title"] = "Rockaway Flower Shop | Florist in Ozone Park, NY – Fresh Bouquets & Same-Day Delivery";
    ViewBag.MetaDescription = "Rockaway Flower Shop in Ozone Park, NY offers fresh flowers, custom bouquets, wedding and event florals, funeral arrangements, and same-day local delivery. Visit 90-01 Rockaway Blvd or call (347) 339-1695 today.";
    Layout = "~/Views/Shared/_Layout.cshtml";

    // Your image filenames (in wwwroot/images/gallery and wwwroot/images/gallery-full)
    var images = new[]
    {
        // Existing images
        "2966293307432705832.JPEG",
        "3611142943485474511.JPEG",
        "8743826365610526321.JPEG",
        "image000005.JPEG",
        "IMG_1224.JPEG",
        "IMG_1247.JPEG",
        "IMG_1273.JPEG",
        "IMG_1274.JPEG",
        "IMG_1300.JPEG",
        "IMG_1303.JPEG",
        "IMG_1311.JPEG",
        "IMG_1312.JPEG",
        "IMG_1313.JPEG",
        "IMG_1314.JPEG",
        "IMG_1316.JPEG",
        "IMG_1319.JPEG",
        "IMG_1320.JPEG",
        "IMG_4894.JPEG",
        "IMG_4913.JPEG",
        "IMG_4896.JPEG",
        "IMG_4897.JPEG",
        "IMG_4903.JPEG",

        // Newly added batch (verified)
        "IMG_1406.JPEG",
        "IMG_1407.JPEG",
        "IMG_1449.JPEG",
        "IMG_1454.JPEG",
        "IMG_1524.JPEG",
        "IMG_1525.JPEG",
        "IMG_1537.JPEG",
        "IMG_1540.JPEG",
        "IMG_1556.JPEG",
        "IMG_1557.JPEG",
        "IMG_4731.JPEG",
        "IMG_4982.JPEG"
    };

    // Base paths (small for carousel, large for lightbox)
    var smallBase = Url.Content("~/images/gallery/");       // thumbnails/smaller
    var fullBase  = Url.Content("~/images/gallery-full/");  // full size
}

<!-- About Section -->
<section id="about" class="container my-5">
    <div class="row">
        <div class="col-md-6 align-top">
            <p>
                We are conveniently located at <strong>90-01 Rockaway Boulevard, Ozone Park NY 11416</strong>, making it easy for residents of Ozone Park and neighboring communities to stop by. Our shop is just minutes away from major avenues and public transportation, so picking up flowers on the way to work, home, or a special event is always simple.
            </p>
            <p>
                Call us at <a href="tel:13473391695">(347) 339-1695</a> or visit in person for the <strong>freshest flowers, custom bouquets, and attentive service</strong> that our customers love. Whether you need a last-minute arrangement, a thoughtful gift, or event florals designed to impress, our team is here to help.
            </p>
            <p>
                We also offer <strong>same-day local delivery</strong> throughout Ozone Park, Howard Beach, South Ozone Park, and nearby neighborhoods—bringing beauty and joy right to your doorstep. Stop in today and let us create something special for you or your loved ones!
            </p>
        </div>

        <div class="col-md-2"></div>

        <div class="col-md-4 text-end">
            <img src="~/images/IMG_4903.JPEG"
                 class="img-fluid rounded shadow"
                 alt="Rockaway Flower Shop"
                 asp-append-version="true"
                 loading="lazy"
                 decoding="async" />
        </div>
    </div>
</section>

<!-- Services Section -->
<section id="services" class="bg-white py-5">
  <div class="container text-center">
    <h2 class="mb-4">Our Services</h2>
    <div class="row g-4">

      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <img src="~/images/gallery/icon_FreshFlowers1.JPEG" alt="Fresh Flowers Icon"
                 class="mb-3 rounded" style="width:120px; height:auto;" loading="lazy" decoding="async">
            <h5 class="card-title">Freshest Flowers Daily</h5>
            <p class="card-text">We provide the freshest flowers every day to brighten any occasion.</p>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <img src="~/images/gallery/icon_CustomBouquets1.JPEG" alt="Custom Bouquets Icon"
                 class="mb-3 rounded" style="width:120px; height:auto;" loading="lazy" decoding="async">
            <h5 class="card-title">Custom Bouquets</h5>
            <p class="card-text">Personalized arrangements tailored to your style and preferences.</p>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <img src="~/images/gallery/icon_SeasonalBouquets.JPEG" alt="Seasonal Bouquets Icon"
                 class="mb-3 rounded" style="width:120px; height:auto;" loading="lazy" decoding="async">
            <h5 class="card-title">Seasonal Fresh Bouquets</h5>
            <p class="card-text">Beautiful seasonal selections created from the finest flowers in bloom.</p>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <img src="~/images/gallery/icon_WeddingArrangements.JPEG" alt="Wedding Arrangements Icon"
                 class="mb-3 rounded" style="width:120px; height:auto;" loading="lazy" decoding="async">
            <h5 class="card-title">Wedding Arrangements</h5>
            <p class="card-text">Elegant floral designs to make your wedding day truly unforgettable.</p>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <img src="~/images/gallery/icon_FuneralAndSympathy1.jpeg" alt="Funeral and Sympathy Flowers Icon"
                 class="mb-3 rounded" style="width:120px; height:auto;" loading="lazy" decoding="async">
            <h5 class="card-title">Funeral & Sympathy Flowers</h5>
            <p class="card-text">Thoughtful and respectful arrangements to honor loved ones.</p>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="card-body">
            <div class="mb-3">
              <i class="bi bi-truck text-success" style="font-size:64px;"></i>
            </div>
            <h5 class="card-title">Local Delivery</h5>
            <p class="card-text">Convenient flower delivery throughout Ozone Park and nearby areas.</p>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- Carousel Header -->
<section class="py-4 text-center bg-light border rounded mb-4 shadow-sm">
    <div class="container">
        <h2 class="fw-bold mb-2">Available Exclusively at Rockaway Flower Shop</h2>
        <p class="lead mb-0">Please call (347) 339-1695 for availability</p>
    </div>
</section>

<!-- Carousel Wrapper -->
<div class="d-flex justify-content-center">
    <div id="shopCarousel" class="carousel slide w-100" style="max-width:1200px;"
         data-bs-ride="carousel" data-bs-interval="3500">

        <!-- Indicators -->
        <div class="carousel-indicators">
            @for (var i = 0; i < images.Length; i++)
            {
                <button type="button"
                        data-bs-target="#shopCarousel"
                        data-bs-slide-to="@i"
                        class="@(i == 0 ? "active" : "")"
                        @(i == 0 ? "aria-current=\"true\"" : null)
                        aria-label="Slide @(i + 1)"></button>
            }
        </div>

        <!-- Slides -->
        <div class="carousel-inner rounded-3 shadow">
            @for (var i = 0; i < images.Length; i++)
            {
                var filename = images[i];
                var smallUrl = smallBase + filename;
                var fullUrl = fullBase + filename;
                var title = System.IO.Path.GetFileNameWithoutExtension(filename);

                <div class="carousel-item @(i == 0 ? "active" : "")">
                    <img src="@smallUrl"
                         data-full="@fullUrl"
                         data-index="@i"
                         class="d-block w-100"
                         style="height:650px; object-fit:cover; cursor:pointer;"
                         alt="@title"
                         title="Click to view"
                         role="button"
                         data-bs-toggle="modal"
                         data-bs-target="#lightboxModal"
                         asp-append-version="true"
                         loading="lazy"
                         decoding="async" />
                </div>
            }
        </div>

        <!-- Controls -->
        <button class="carousel-control-prev" type="button" data-bs-target="#shopCarousel" data-bs-slide="prev" aria-label="Previous">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#shopCarousel" data-bs-slide="next" aria-label="Next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
        </button>
    </div>
</div>

<!-- Lightbox Modal -->
<div class="modal fade" id="lightboxModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content bg-black">
            <div class="modal-header border-0">
                <h5 class="modal-title text-white" id="lightboxCaption"></h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body p-0 position-relative">
                <img id="lightboxImg" src="" alt="" class="img-fluid w-100"
                     style="max-height:85vh; object-fit:contain;" />

                <button type="button" id="lightboxPrev"
                        class="btn btn-light position-absolute top-50 start-0 translate-middle-y ms-2"
                        aria-label="Previous">‹</button>

                <button type="button" id="lightboxNext"
                        class="btn btn-light position-absolute top-50 end-0 translate-middle-y me-2"
                        aria-label="Next">›</button>
            </div>

            <div class="modal-footer justify-content-between border-0">
                <a id="lightboxDownload" class="btn btn-outline-light" href="#" target="_blank" download>Download</a>
                <a id="lightboxOpenNew" class="btn btn-outline-light" href="#" target="_blank" rel="noopener">Open in new tab</a>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        (function () {
            // Guard: if Bootstrap JS isn't loaded, don't hard-break the page
            if (!window.bootstrap) return;

            const carouselEl = document.getElementById('shopCarousel');
            if (!carouselEl) return;

            const carousel = bootstrap.Carousel.getOrCreateInstance(carouselEl);

            // Pause carousel on hover
            carouselEl.addEventListener('mouseenter', () => carousel.pause());
            carouselEl.addEventListener('mouseleave', () => carousel.cycle());

            // Lightbox logic
            const modalEl = document.getElementById('lightboxModal');
            const modal = bootstrap.Modal.getOrCreateInstance(modalEl);

            const imgs = Array.from(document.querySelectorAll('#shopCarousel .carousel-item img'));
            const lbImg = document.getElementById('lightboxImg');
            const lbCaption = document.getElementById('lightboxCaption');
            const btnPrev = document.getElementById('lightboxPrev');
            const btnNext = document.getElementById('lightboxNext');
            const linkDownload = document.getElementById('lightboxDownload');
            const linkOpenNew = document.getElementById('lightboxOpenNew');

            let currentIndex = 0;

            function showLightbox(index) {
                if (!imgs.length) return;

                // Wrap both directions
                index = (index + imgs.length) % imgs.length;
                currentIndex = index;

                const el = imgs[currentIndex];
                const full = el.getAttribute('data-full') || el.src;
                const caption = el.getAttribute('alt') || '';

                lbImg.src = full;
                lbImg.alt = caption;
                lbCaption.textContent = caption;

                linkDownload.href = full;
                linkOpenNew.href = full;
            }

            imgs.forEach(img => {
                img.addEventListener('click', () => {
                    const idx = parseInt(img.getAttribute('data-index'), 10);
                    showLightbox(Number.isFinite(idx) ? idx : 0);
                    carousel.pause();
                });
            });

            btnPrev.addEventListener('click', () => showLightbox(currentIndex - 1));
            btnNext.addEventListener('click', () => showLightbox(currentIndex + 1));

            // Keyboard nav when modal is open
            let keyHandler = null;

            modalEl.addEventListener('shown.bs.modal', () => {
                keyHandler = (e) => {
                    if (e.key === 'ArrowLeft') btnPrev.click();
                    if (e.key === 'ArrowRight') btnNext.click();
                };
                document.addEventListener('keydown', keyHandler);
            });

            modalEl.addEventListener('hidden.bs.modal', () => {
                if (keyHandler) {
                    document.removeEventListener('keydown', keyHandler);
                    keyHandler = null;
                }
                carousel.cycle();
            });
        })();
    </script>
}

<!-- Contact Section -->
<section id="contact" class="container my-5">
    <div class="row g-4">
        <div class="col-md-6">
            <h2>Visit or Contact Us</h2>
            <address class="mb-2">
                <a class="fw-semibold" target="_blank" rel="noopener"
                   href="https://maps.google.com/?q=90-01+Rockaway+Boulevard+Ozone+Park+NY+11416">Rockaway Flower Shop</a>
                <div>90-01 Rockaway Boulevard</div>
                <div>Ozone Park, NY 11416</div>
            </address>
            <p class="mb-1">📞 <a href="tel:13473391695">(347) 339-1695</a></p>
            <p class="mb-3">📧 <a href="mailto:rockawayflower@gmail.com">rockawayflower@gmail.com</a></p>
        </div>

        <div class="col-md-6">
            <h2>Hours</h2>
            <ul class="list-unstyled small">
                <li class="d-flex justify-content-between"><span>Monday</span><span>9:00 AM – 8:00 PM</span></li>
                <li class="d-flex justify-content-between"><span>Tuesday</span><span>9:00 AM – 8:00 PM</span></li>
                <li class="d-flex justify-content-between"><span>Wednesday</span><span>9:00 AM – 8:00 PM</span></li>
                <li class="d-flex justify-content-between"><span>Thursday</span><span>9:00 AM – 8:00 PM</span></li>
                <li class="d-flex justify-content-between"><span>Friday</span><span>9:00 AM – 8:00 PM</span></li>
                <li class="d-flex justify-content-between"><span>Saturday</span><span>9:00 AM – 8:00 PM</span></li>
                <li class="d-flex justify-content-between"><span>Sunday</span><span>9:00 AM – 8:00 PM</span></li>
            </ul>
        </div>
    </div>
</section>
